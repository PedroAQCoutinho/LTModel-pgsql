--Breaking municipalities by biome
DROP TABLE IF EXISTS lt_model.v_pacotes_proc01_breakbiome; 
DROP TABLE
CREATE TABLE lt_model.v_pacotes_proc01_breakbiome
(
  cd_mun integer,
  cd_bioma integer,
  geom geometry
);
CREATE TABLE

--Breaking municipalities+biome by ottobacia
DROP TABLE IF EXISTS lt_model.v_pacotes_proc02_ottobacia;
DROP TABLE
CREATE TABLE lt_model.v_pacotes_proc02_ottobacia
(
  cd_mun bigint,
  cd_bioma integer,
  cd_bacia character varying(14),
  geom geometry
);
CREATE TABLE

--Table with rural properties and unregistred lands
DROP TABLE IF EXISTS lt_model.v_pacotes_proc03_unregistered; 
DROP TABLE
CREATE TABLE lt_model.v_pacotes_proc03_unregistered
(
  gid integer,
  cd_mun bigint,
  cd_bioma integer,
  cd_bacia character varying(14),
  geom geometry
);
CREATE TABLE

--Table with rural properties breaks
DROP TABLE IF EXISTS lt_model.v_pacotes_proc04_flagprop; 
DROP TABLE
CREATE TABLE lt_model.v_pacotes_proc04_flagprop
(
  gid integer,
  cd_mun bigint,
  cd_bioma integer,
  cd_bacia character varying(14),
  geom geometry
);
CREATE TABLE

--Table with final dataset
DROP TABLE IF EXISTS lt_model.v_pacotes_proc05_imoveisfull; 
DROP TABLE
CREATE TABLE lt_model.v_pacotes_proc05_imoveisfull
(
  gid integer,
  cd_mun bigint,
  cd_bioma integer,
  cd_bacia character varying(14),
  geom geometry
);
CREATE TABLE
 num_proc 
----------
       22
(1 row)

 num_proc 
----------
       23
(1 row)

 num_proc 
----------
       24
(1 row)

 num_proc 
----------
       25
(1 row)

 num_proc 
----------
       26
(1 row)

 num_proc 
----------
       27
(1 row)

 num_proc 
----------
       28
(1 row)

 num_proc 
----------
       29
(1 row)

 num_proc 
----------
       30
(1 row)

 num_proc 
----------
       31
(1 row)

 num_proc 
----------
       32
(1 row)

 num_proc 
----------
       33
(1 row)

 num_proc 
----------
       34
(1 row)

 num_proc 
----------
       35
(1 row)

 num_proc 
----------
       36
(1 row)

 num_proc 
----------
       37
(1 row)

 num_proc 
----------
       38
(1 row)

 num_proc 
----------
       39
(1 row)

 num_proc 
----------
       40
(1 row)

 num_proc 
----------
       41
(1 row)

 num_proc 
----------
       42
(1 row)

 num_proc 
----------
       43
(1 row)

 num_proc 
----------
       44
(1 row)

 num_proc 
----------
       45
(1 row)

 num_proc 
----------
       46
(1 row)

 num_proc 
----------
       47
(1 row)

 num_proc 
----------
       48
(1 row)

 num_proc 
----------
       49
(1 row)

 num_proc 
----------
       50
(1 row)

 num_proc 
----------
       51
(1 row)

 num_proc 
----------
       52
(1 row)

 num_proc 
----------
        0
(1 row)

 num_proc 
----------
        1
(1 row)

 num_proc 
----------
        2
(1 row)

 num_proc 
----------
        3
(1 row)

 num_proc 
----------
        4
(1 row)

 num_proc 
----------
        5
(1 row)

 num_proc 
----------
        6
(1 row)

 num_proc 
----------
        7
(1 row)

 num_proc 
----------
        8
(1 row)

 num_proc 
----------
        9
(1 row)

 num_proc 
----------
       10
(1 row)

 num_proc 
----------
       11
(1 row)

 num_proc 
----------
       12
(1 row)

 num_proc 
----------
       13
(1 row)

 num_proc 
----------
       14
(1 row)

 num_proc 
----------
       15
(1 row)

 num_proc 
----------
       16
(1 row)

 num_proc 
----------
       17
(1 row)

 num_proc 
----------
       18
(1 row)

 num_proc 
----------
       19
(1 row)

 num_proc 
----------
       20
(1 row)

 num_proc 
----------
       21
(1 row)

 num_proc 
----------
       53
(1 row)

 num_proc 
----------
       54
(1 row)

 num_proc 
----------
       55
(1 row)

INSERT 0 98
 num_proc 
----------
       30
(1 row)

INSERT 0 90
 num_proc 
----------
       47
(1 row)

INSERT 0 102
INSERT 0 92
 num_proc 
----------
       10
(1 row)

 num_proc 
----------
       18
(1 row)

INSERT 0 99
 num_proc 
----------
       19
(1 row)

INSERT 0 92
INSERT 0 99
 num_proc 
----------
       55
(1 row)

 num_proc 
----------
       43
(1 row)

INSERT 0 92
 num_proc 
----------
       34
(1 row)

INSERT 0 123
 num_proc 
----------
       17
(1 row)

INSERT 0 92
 num_proc 
----------
       26
(1 row)

INSERT 0 102
 num_proc 
----------
       42
(1 row)

INSERT 0 99
 num_proc 
----------
        6
(1 row)

INSERT 0 98
 num_proc 
----------
       23
(1 row)

INSERT 0 108
 num_proc 
----------
       39
(1 row)

INSERT 0 99
 num_proc 
----------
       22
(1 row)

INSERT 0 108
 num_proc 
----------
       35
(1 row)

INSERT 0 106
 num_proc 
----------
       38
(1 row)

INSERT 0 123
 num_proc 
----------
       12
(1 row)

INSERT 0 117
 num_proc 
----------
       13
(1 row)

INSERT 0 116
 num_proc 
----------
       21
(1 row)

INSERT 0 98
 num_proc 
----------
       27
(1 row)

INSERT 0 103
 num_proc 
----------
       11
(1 row)

INSERT 0 105
 num_proc 
----------
       50
(1 row)

INSERT 0 128
 num_proc 
----------
       29
(1 row)

INSERT 0 101
 num_proc 
----------
       14
(1 row)

INSERT 0 98
 num_proc 
----------
       51
(1 row)

INSERT 0 103
 num_proc 
----------
        7
(1 row)

INSERT 0 123
 num_proc 
----------
        5
(1 row)

INSERT 0 118
 num_proc 
----------
        0
(1 row)

INSERT 0 106
 num_proc 
----------
        3
(1 row)

INSERT 0 128
 num_proc 
----------
        8
(1 row)

INSERT 0 126
 num_proc 
----------
        4
(1 row)

INSERT 0 108
 num_proc 
----------
        2
(1 row)

INSERT 0 110
 num_proc 
----------
       54
(1 row)

INSERT 0 132
 num_proc 
----------
       25
(1 row)

INSERT 0 124
 num_proc 
----------
       52
(1 row)

INSERT 0 122
 num_proc 
----------
       41
(1 row)

INSERT 0 107
 num_proc 
----------
       15
(1 row)

INSERT 0 134
 num_proc 
----------
       32
(1 row)

INSERT 0 131
 num_proc 
----------
       48
(1 row)

INSERT 0 131
 num_proc 
----------
       53
(1 row)

INSERT 0 113
INSERT 0 129
 num_proc 
----------
       46
(1 row)

 num_proc 
----------
       28
(1 row)

INSERT 0 132
 num_proc 
----------
       20
(1 row)

INSERT 0 133
 num_proc 
----------
       49
(1 row)

INSERT 0 126
 num_proc 
----------
        9
(1 row)

INSERT 0 102
INSERT 0 127
 num_proc 
----------
       31
(1 row)

 num_proc 
----------
       45
(1 row)

INSERT 0 118
 num_proc 
----------
        1
(1 row)

INSERT 0 131
 num_proc 
----------
       40
(1 row)

INSERT 0 134
 num_proc 
----------
       44
(1 row)

INSERT 0 140
 num_proc 
----------
       24
(1 row)

INSERT 0 121
 num_proc 
----------
       37
(1 row)

INSERT 0 140
 num_proc 
----------
       33
(1 row)

INSERT 0 137
 num_proc 
----------
       36
(1 row)

INSERT 0 7116
 num_proc 
----------
       10
(1 row)

INSERT 0 7151
 num_proc 
----------
       43
(1 row)

INSERT 0 6866
 num_proc 
----------
       34
(1 row)

INSERT 0 8614
 num_proc 
----------
       18
(1 row)

INSERT 0 7475
 num_proc 
----------
       47
(1 row)

INSERT 0 7568
 num_proc 
----------
       35
(1 row)

INSERT 0 6952
 num_proc 
----------
       14
(1 row)

INSERT 0 7276
 num_proc 
----------
       11
(1 row)

INSERT 0 7181
 num_proc 
----------
       23
(1 row)

INSERT 0 8259
 num_proc 
----------
       19
(1 row)

INSERT 0 9108
 num_proc 
----------
        6
(1 row)

INSERT 0 9358
 num_proc 
----------
       12
(1 row)

INSERT 0 8995
 num_proc 
----------
       38
(1 row)

INSERT 0 9303
 num_proc 
----------
        0
(1 row)

INSERT 0 9285
 num_proc 
----------
        5
(1 row)

INSERT 0 9407
 num_proc 
----------
        1
(1 row)

INSERT 0 10348
 num_proc 
----------
       42
(1 row)

INSERT 0 8315
 num_proc 
----------
       51
(1 row)

INSERT 0 9729
INSERT 0 8842
INSERT 0 8582
 num_proc 
----------
       25
(1 row)

 num_proc 
----------
       44
(1 row)

 num_proc 
----------
        2
(1 row)

INSERT 0 8332
 num_proc 
----------
       41
(1 row)

INSERT 0 8617
 num_proc 
----------
       15
(1 row)

INSERT 0 10092
 num_proc 
----------
       28
(1 row)

INSERT 0 8522
 num_proc 
----------
       27
(1 row)

INSERT 0 10042
 num_proc 
----------
       50
(1 row)

INSERT 0 9228
 num_proc 
----------
        3
(1 row)

INSERT 0 11135
 num_proc 
----------
       48
(1 row)

INSERT 0 10115
 num_proc 
----------
        9
(1 row)

INSERT 0 10683
 num_proc 
----------
       21
(1 row)

INSERT 0 9921
 num_proc 
----------
       36
(1 row)

INSERT 0 9674
 num_proc 
----------
       22
(1 row)

INSERT 0 11369
INSERT 0 11776
 num_proc 
----------
       54
(1 row)

 num_proc 
----------
       40
(1 row)

INSERT 0 11437
 num_proc 
----------
       45
(1 row)

INSERT 0 10322
 num_proc 
----------
       39
(1 row)

INSERT 0 9418
 num_proc 
----------
       31
(1 row)

INSERT 0 13254
 num_proc 
----------
       29
(1 row)

INSERT 0 10651
 num_proc 
----------
        8
(1 row)

INSERT 0 9941
 num_proc 
----------
       30
(1 row)

INSERT 0 10931
 num_proc 
----------
       37
(1 row)

INSERT 0 11114
 num_proc 
----------
       55
(1 row)

INSERT 0 13423
 num_proc 
----------
       53
(1 row)

INSERT 0 8772
 num_proc 
----------
       13
(1 row)

INSERT 0 9126
 num_proc 
----------
        7
(1 row)

INSERT 0 9625
 num_proc 
----------
       46
(1 row)

INSERT 0 13552
 num_proc 
----------
       20
(1 row)

INSERT 0 12014
 num_proc 
----------
       52
(1 row)

INSERT 0 16041
 num_proc 
----------
        4
(1 row)

INSERT 0 12707
 num_proc 
----------
       32
(1 row)

INSERT 0 14092
 num_proc 
----------
       49
(1 row)

INSERT 0 14094
 num_proc 
----------
       24
(1 row)

INSERT 0 12285
 num_proc 
----------
       26
(1 row)

INSERT 0 11646
 num_proc 
----------
       17
(1 row)

INSERT 0 120
 num_proc 
----------
       16
(1 row)

INSERT 0 16665
 num_proc 
----------
       33
(1 row)

INSERT 0 10108
 num_proc 
----------
       16
(1 row)

INSERT 0 108736
 num_proc 
----------
       51
(1 row)

INSERT 0 131861
INSERT 0 100524
 num_proc 
----------
       10
(1 row)

INSERT 0 106698
 num_proc 
----------
        1
(1 row)

INSERT 0 133980
INSERT 0 135876
INSERT 0 118797
 num_proc 
----------
       44
(1 row)

INSERT 0 142492
INSERT 0 137864
 num_proc 
----------
       21
(1 row)

INSERT 0 173603
INSERT 0 88932
 num_proc 
----------
       43
(1 row)

INSERT 0 109625
 num_proc 
----------
       35
(1 row)

INSERT 0 115548
INSERT 0 134388
INSERT 0 114535
 num_proc 
----------
       22
(1 row)

INSERT 0 84687
 num_proc 
----------
       27
(1 row)

INSERT 0 142195
INSERT 0 101757
 num_proc 
----------
       47
(1 row)

INSERT 0 123183
 num_proc 
----------
        0
(1 row)

INSERT 0 130162
 num_proc 
----------
        5
(1 row)

INSERT 0 117043
INSERT 0 119711
INSERT 0 168697
INSERT 0 160034
INSERT 0 111816
 num_proc 
----------
       12
(1 row)

INSERT 0 149583
INSERT 0 132872
 num_proc 
----------
       54
(1 row)

INSERT 0 115124
 num_proc 
----------
       38
(1 row)

INSERT 0 156247
INSERT 0 85358
 num_proc 
----------
       34
(1 row)

INSERT 0 93234
 num_proc 
----------
       14
(1 row)

INSERT 0 156006
INSERT 0 134251
 num_proc 
----------
       48
(1 row)

INSERT 0 113482
 num_proc 
----------
       55
(1 row)

INSERT 0 127658
INSERT 0 92712
 num_proc 
----------
       18
(1 row)

INSERT 0 115104
INSERT 0 154546
INSERT 0 169685
INSERT 0 124709
INSERT 0 106581
 num_proc 
----------
       11
(1 row)

INSERT 0 138396
 num_proc 
----------
       40
(1 row)

INSERT 0 119934
 num_proc 
----------
        3
(1 row)

INSERT 0 140351
INSERT 0 147869
INSERT 0 176887
INSERT 0 137891
 num_proc 
----------
       45
(1 row)

INSERT 0 102354
 num_proc 
----------
       41
(1 row)

INSERT 0 96483
 num_proc 
----------
        2
(1 row)

INSERT 0 191401
INSERT 0 128589
INSERT 0 130542
 num_proc 
----------
       46
(1 row)

INSERT 0 128066
INSERT 0 125498
 num_proc 
----------
       25
(1 row)

INSERT 0 145707
INSERT 0 167091
INSERT 0 140797
 num_proc 
----------
       37
(1 row)

INSERT 0 178153
INSERT 0 107048
 num_proc 
----------
        7
(1 row)

INSERT 0 110746
 num_proc 
----------
       19
(1 row)

INSERT 0 130934
INSERT 0 109340
 num_proc 
----------
       30
(1 row)

INSERT 0 131242
INSERT 0 123601
INSERT 0 110702
 num_proc 
----------
       42
(1 row)

INSERT 0 132293
 num_proc 
----------
       52
(1 row)

INSERT 0 141542
INSERT 0 181999
INSERT 0 130466
 num_proc 
----------
       16
(1 row)

INSERT 0 161782
INSERT 0 117627
 num_proc 
----------
       39
(1 row)

INSERT 0 147495
INSERT 0 85373
 num_proc 
----------
       23
(1 row)

INSERT 0 145794
 num_proc 
----------
       49
(1 row)

INSERT 0 115303
 num_proc 
----------
       17
(1 row)

INSERT 0 153885
 num_proc 
----------
        8
(1 row)

INSERT 0 107617
INSERT 0 185933
INSERT 0 153120
INSERT 0 188457
INSERT 0 134871
 num_proc 
----------
       28
(1 row)

INSERT 0 101284
 num_proc 
----------
       15
(1 row)

INSERT 0 106959
 num_proc 
----------
       50
(1 row)

INSERT 0 165560
INSERT 0 144504
INSERT 0 147108
INSERT 0 106233
 num_proc 
----------
       13
(1 row)

INSERT 0 141608
 num_proc 
----------
       29
(1 row)

INSERT 0 139654
INSERT 0 112463
 num_proc 
----------
       31
(1 row)

INSERT 0 187062
INSERT 0 133219
INSERT 0 117450
 num_proc 
----------
        9
(1 row)

INSERT 0 156408
INSERT 0 131174
 num_proc 
----------
       36
(1 row)

INSERT 0 169956
INSERT 0 188864
 num_proc 
----------
       20
(1 row)

INSERT 0 212751
INSERT 0 168307
 num_proc 
----------
       53
(1 row)

INSERT 0 210175
INSERT 0 108205
 num_proc 
----------
        6
(1 row)

INSERT 0 128836
 num_proc 
----------
       26
(1 row)

INSERT 0 126499
INSERT 0 149255
INSERT 0 141633
 num_proc 
----------
       32
(1 row)

INSERT 0 183375
INSERT 0 146746
 num_proc 
----------
       24
(1 row)

INSERT 0 192183
INSERT 0 174549
 num_proc 
----------
       33
(1 row)

INSERT 0 203311
INSERT 0 159098
 num_proc 
----------
        4
(1 row)

INSERT 0 190242
--Building complete landtenure dataset
INSERT INTO lt_model.v_pacotes_proc05_imoveisfull
    SELECT * FROM lt_model.v_pacotes_proc03_unregistered AS a
    UNION ALL
    SELECT * FROM lt_model.v_pacotes_proc04_flagprop AS b;
INSERT 0 15387746
